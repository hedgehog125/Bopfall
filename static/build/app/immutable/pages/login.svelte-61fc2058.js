import{S as Y,i as z,s as J,l as T,m as N,q as b,b as L,n as R,h as w,K as re,L as ie,a as F,x as G,u as I,p as P,c as j,y as Q,v as A,J as y,z as X,M as K,N as oe,O as se,w as Z,f as x,t as $,C as ee,P as D}from"../chunks/index-13519574.js";import{l as le}from"../chunks/LinkPage-a185863e.js";import"../chunks/paths-abcb058a.js";const ue={setTimeoutOrImmediate:(r,e,...t)=>{if(e<=0)r(...t);else return setTimeout(r,e,...t)}},ae={mime:r=>{const e=r.headers.get("content-type");return e==null?"":e.split(";")[0]}},ce={check:async r=>{if(!navigator.onLine)return!1;try{await fetch(le("ping"))}catch{return!1}return!0}};function fe(r){let e;return{c(){e=T("br"),this.h()},l(t){e=N(t,"BR",{class:!0}),this.h()},h(){b(e,"class","svelte-t39mn0")},m(t,i){L(t,e,i)},p:R,i:R,o:R,d(t){t&&w(e)}}}class me extends Y{constructor(e){super(),z(this,e,null,fe,J,{})}}function pe(r,e,t){let{input:i}=e,{output:n}=e,{showAfter:o=150}=e,{minShowTime:a=500}=e,c,l,u,f;const h=p=>{n==null&&(t(0,n=i),f=i),i!=f&&(f=i,i?c==null&&(u!=null&&clearTimeout(u),c=setTimeout(E=>{t(0,n=!0),l=new Date},o)):u==null&&(c!=null&&clearTimeout(c),u=ue.setTimeoutOrImmediate(E=>{t(0,n=!1)},a-(new Date-l))))};return r.$$set=p=>{"input"in p&&t(1,i=p.input),"output"in p&&t(0,n=p.output),"showAfter"in p&&t(2,o=p.showAfter),"minShowTime"in p&&t(3,a=p.minShowTime)},r.$$.update=()=>{r.$$.dirty&2&&h()},[n,i,o,a]}class he extends Y{constructor(e){super(),z(this,e,pe,null,J,{input:1,output:0,showAfter:2,minShowTime:3})}}function _e(r){let e;return{c(){e=I("Now enter your password...")},l(t){e=A(t,"Now enter your password...")},m(t,i){L(t,e,i)},d(t){t&&w(e)}}}function de(r){let e;return{c(){e=I("Now enter your setup code...")},l(t){e=A(t,"Now enter your setup code...")},m(t,i){L(t,e,i)},d(t){t&&w(e)}}}function be(r){let e;return{c(){e=I("Enter the domain of your server...")},l(t){e=A(t,"Enter the domain of your server...")},m(t,i){L(t,e,i)},d(t){t&&w(e)}}}function ne(r){let e,t,i=r[7][r[4]]+"",n,o,a=r[4]+1+"",c,l;return{c(){e=T("div"),t=T("p"),n=I(i),o=I("... ("),c=I(a),l=I("/2)"),this.h()},l(u){e=N(u,"DIV",{class:!0});var f=P(e);t=N(f,"P",{});var h=P(t);n=A(h,i),o=A(h,"... ("),c=A(h,a),l=A(h,"/2)"),h.forEach(w),f.forEach(w),this.h()},h(){b(e,"class","svelte-cf0r9w")},m(u,f){L(u,e,f),y(e,t),y(t,n),y(t,o),y(t,c),y(t,l)},p(u,f){f&16&&i!==(i=u[7][u[4]]+"")&&Z(n,i),f&16&&a!==(a=u[4]+1+"")&&Z(c,a)},d(u){u&&w(e)}}}function we(r){let e,t,i;return{c(){e=T("input"),this.h()},l(n){e=N(n,"INPUT",{type:!0,"aria-label":!0,placeholder:!0,name:!0,autocomplete:!0}),this.h()},h(){b(e,"type","password"),b(e,"aria-label","Your password"),b(e,"placeholder","Enter your password..."),b(e,"name","password"),b(e,"autocomplete","current-password")},m(n,o){L(n,e,o),D(e,r[2]),t||(i=K(e,"input",r[14]),t=!0)},p(n,o){o&4&&e.value!==n[2]&&D(e,n[2])},d(n){n&&w(e),t=!1,i()}}}function ge(r){let e,t,i;return{c(){e=T("input"),this.h()},l(n){e=N(n,"INPUT",{type:!0,"aria-label":!0,placeholder:!0,autocomplete:!0}),this.h()},h(){b(e,"type","text"),b(e,"aria-label","Your setup code"),b(e,"placeholder","Enter your setup code..."),b(e,"autocomplete","one-time-code")},m(n,o){L(n,e,o),D(e,r[2]),t||(i=K(e,"input",r[13]),t=!0)},p(n,o){o&4&&e.value!==n[2]&&D(e,n[2])},d(n){n&&w(e),t=!1,i()}}}function ye(r){let e,t,i;return{c(){e=T("input"),this.h()},l(n){e=N(n,"INPUT",{type:!0,"aria-label":!0,placeholder:!0,name:!0,autocomplete:!0}),this.h()},h(){b(e,"type","text"),b(e,"aria-label","The domain name to connect to"),b(e,"placeholder","Enter a domain..."),b(e,"name","username"),b(e,"autocomplete","username")},m(n,o){L(n,e,o),D(e,r[1]),t||(i=K(e,"input",r[12]),t=!0)},p(n,o){o&2&&e.value!==n[1]&&D(e,n[1])},d(n){n&&w(e),t=!1,i()}}}function ke(r){let e,t,i,n,o,a,c,l,u,f,h,p,E=r[3]==0?"Next":"Connect",M,C,k,q;function H(s,_){return s[3]==0?be:s[5]?de:_e}let O=H(r),v=O(r);function W(s){r[11](s)}let g={input:r[6]};r[0]!==void 0&&(g.output=r[0]),n=new he({props:g}),re.push(()=>ie(n,"output",W));let m=r[0]&&ne(r);function d(s,_){return s[3]==0?ye:s[5]?ge:we}let U=d(r),S=U(r);return f=new me({}),{c(){e=T("main"),t=T("h2"),v.c(),i=F(),G(n.$$.fragment),a=F(),m&&m.c(),c=F(),l=T("form"),S.c(),u=F(),G(f.$$.fragment),h=F(),p=T("button"),M=I(E),this.h()},l(s){e=N(s,"MAIN",{});var _=P(e);t=N(_,"H2",{});var V=P(t);v.l(V),V.forEach(w),i=j(_),Q(n.$$.fragment,_),a=j(_),m&&m.l(_),c=j(_),l=N(_,"FORM",{});var B=P(l);S.l(B),u=j(B),Q(f.$$.fragment,B),h=j(B),p=N(B,"BUTTON",{type:!0});var te=P(p);M=A(te,E),te.forEach(w),B.forEach(w),_.forEach(w),this.h()},h(){b(p,"type","submit")},m(s,_){L(s,e,_),y(e,t),v.m(t,null),y(e,i),X(n,e,null),y(e,a),m&&m.m(e,null),y(e,c),y(e,l),S.m(l,null),y(l,u),X(f,l,null),y(l,h),y(l,p),y(p,M),C=!0,k||(q=K(l,"submit",oe(r[8])),k=!0)},p(s,[_]){O!==(O=H(s))&&(v.d(1),v=O(s),v&&(v.c(),v.m(t,null)));const V={};_&64&&(V.input=s[6]),!o&&_&1&&(o=!0,V.output=s[0],se(()=>o=!1)),n.$set(V),s[0]?m?m.p(s,_):(m=ne(s),m.c(),m.m(e,c)):m&&(m.d(1),m=null),U===(U=d(s))&&S?S.p(s,_):(S.d(1),S=U(s),S&&(S.c(),S.m(l,u))),(!C||_&8)&&E!==(E=s[3]==0?"Next":"Connect")&&Z(M,E)},i(s){C||(x(n.$$.fragment,s),x(f.$$.fragment,s),C=!0)},o(s){$(n.$$.fragment,s),$(f.$$.fragment,s),C=!1},d(s){s&&w(e),v.d(),ee(n),m&&m.d(),S.d(),ee(f),k=!1,q()}}}function ve(r,e,t){let i,{onLoginSuccess:n}=e,o,a,c,l=0,u;const f=["Pinging server","Waiting for the server to start"];let h,p,E=!1;const M=async g=>{if(l==1){if(await p,l!=1||h!="ok"||!await q())return;n()}else t(3,l=1),p=C()},C=async g=>{let m=a.includes("://")?a:"https://"+a;t(10,h="checking"),t(4,u=0);let d;try{d=await fetch(`${m}/info`)}catch{k(0);return}if(ae.mime(d)!="application/json"){k(1);return}try{d=await d.json()}catch{k(1);return}if(d.type!="Bopfall"){k(1);return}if(d.status=="error"){k(2);return}t(4,u=1);try{d=await fetch(`${m}/waitUntilStart`)}catch{k(0);return}if(d.ok)d.text();else{k(2);return}t(10,h="ok");try{d=await fetch(`${m}/info/passwordSet`)}catch{k(0);return}d.ok&&(d=await d.text(),t(5,E=d==="false"))},k=async g=>{if(t(10,h="invalid"),g==0){if(!await ce.check())return}else if(g!=1){if(g!=2){if(g==3){t(2,c="");return}}}t(3,l=0),t(1,a="")},q=async(g,m)=>{};function H(g){o=g,t(0,o)}function O(){a=this.value,t(1,a)}function v(){c=this.value,t(2,c)}function W(){c=this.value,t(2,c)}return r.$$set=g=>{"onLoginSuccess"in g&&t(9,n=g.onLoginSuccess)},r.$$.update=()=>{r.$$.dirty&1024&&t(6,i=h=="checking")},[o,a,c,l,u,E,i,f,M,n,h,H,O,v,W]}class Se extends Y{constructor(e){super(),z(this,e,ve,ke,J,{onLoginSuccess:9})}}function Te(r){let e,t,i;return t=new Se({}),{c(){e=T("main"),G(t.$$.fragment)},l(n){e=N(n,"MAIN",{});var o=P(e);Q(t.$$.fragment,o),o.forEach(w)},m(n,o){L(n,e,o),X(t,e,null),i=!0},p:R,i(n){i||(x(t.$$.fragment,n),i=!0)},o(n){$(t.$$.fragment,n),i=!1},d(n){n&&w(e),ee(t)}}}class Ie extends Y{constructor(e){super(),z(this,e,null,Te,J,{})}}export{Ie as default};
